<h1 id="bookings-h1">Your Bookings as a renter</h1>
<div class="bookings-grid">
  <% @bookings.sort.each do |booking| %>
    <div class="bookings-card-product">
      <%= link_to castle_path(booking.castle), class: "booking-infos" do %>
        <div class="booking-img"  style="background-image: url('<%= if booking.castle.photo then cl_image_path booking.castle.photo.key end %>')">
        </div>
        <div class="booking-text">
          <h5><%= booking.castle.title %></h5>
          <h6><span class="icone-location"><i class="fa-sharp fa-solid fa-location-dot"></i></span><%= booking.castle.location %></h6>
          <p><strong>from</strong> <%= booking.check_in.strftime("%A %d %B %Y")%></p>
          <p><strong>to</strong> <%= booking.check_out.strftime("%A %d %B %Y") %></p>
          <p><strong><%= booking.total_price %> â‚¬</strong></p>
        </div>
      <% end %>
      <div class="bookings-validations">
        <div class="bookings-situation">
          <p class="confirmation-status-pending"><strong>
            <%=
              case booking.validates
              when "accepted"
                "Booking accepted"
              when "declined"
                "Booking declined"
              else
                "Waiting for acceptation"
              end
            %></strong>
          </p>
        </div>
        <% case current_user %>
        <% when booking.user %>
          <%=
                  link_to booking_path(booking),
                  data: {turbo_method: :delete, turbo_confirm: "Are you sure you want to cancel ?"},
                  class:"booking-cancel" do
           %>
            <i class="fa-solid fa-square-xmark"></i>
           <% end %>
        <% when current_user == booking.castle.user %>
          <div class="bookings-acceptation">
            <div>
              <%= link_to 'Owner only : Accept',
                accept_owner_booking_path(booking),
                data: {turbo_method: :patch, turbo_confirm: "Are you sure you want to accept?"},
                class:"btn-accept"
              %>
            </div>
            <div>
              <%= link_to 'Owner only : Decline',
                decline_owner_booking_path(booking),
                data: {turbo_method: :patch, turbo_confirm: "Are you sure you want to accept?"},
                class:"btn-decline"
              %>
            </div>
            <div>
              <%= link_to 'Owner only : Cancel decision',
                cancel_decision_owner_booking_path(booking),
                data: {turbo_method: :patch, turbo_confirm: "Are you sure you want to accept?"},
                calss:"btn-cancel-decision"
              %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  <% end %>
</div>
